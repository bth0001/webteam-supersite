window.docxtemplater=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){"use strict";var n=r(6),o=n.DOMParser,a=n.XMLSerializer,i=r(1).throwXmlTagNotFound;function s(e){return e[e.length-1]}var u={nullGetter:function(e){return e.module?(e.module,""):"undefined"},xmlFileNames:[],parser:function(e){return function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},"get",function(t){return"."===e?t:t[e]})},linebreaks:!1,delimiters:{start:"{",end:"}"}};var l={"&":"&amp;","'":"&apos;","<":"&lt;",">":"&gt;",'"':"&quot;"},p=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;function c(e){return e.replace(p,"\\$&")}var f=Object.keys(l).map(function(e){var t=l[e];return{rstart:new RegExp(c(t),"g"),rend:new RegExp(c(e),"g"),start:t,end:e}});var h=new RegExp(String.fromCharCode(160),"g");function d(e,t){var r=t.type,n=t.tag,o=t.position;return"tag"===r&&n===e&&"start"===o}function g(e,t){var r=t.type,n=t.tag,o=t.position;return"tag"===r&&n===e&&"end"===o}var v=/[\x00-\x08\x0B\x0C\x0E-\x1F]/;e.exports={endsWith:function(e,t){return-1!==e.indexOf(t,e.length-t.length)},startsWith:function(e,t){return e.substring(0,t.length)===t},isContent:function(e){return"placeholder"===e.type||"content"===e.type&&"insidetag"===e.position},isParagraphStart:function(e){return d("w:p",e)||d("a:p",e)},isParagraphEnd:function(e){return g("w:p",e)||g("a:p",e)},isTagStart:d,isTagEnd:g,isTextStart:function(e){return"tag"===e.type&&"start"===e.position&&e.text},isTextEnd:function(e){return"tag"===e.type&&"end"===e.position&&e.text},unique:function(e){for(var t={},r=[],n=0,o=e.length;n<o;++n)t.hasOwnProperty(e[n])||(t[e[n]]=!0,r.push(e[n]));return r},chunkBy:function(e,t){return e.reduce(function(e,r){var n=s(e);if(0===n.length)return n.push(r),e;var o=t(r);return"start"===o?e.push([r]):"end"===o?(n.push(r),e.push([])):n.push(r),e},[[]]).filter(function(e){return e.length>0})},last:s,mergeObjects:function(){for(var e={},t=void 0,r=void 0,n=0;n<arguments.length;n+=1){t=arguments[n],r=Object.keys(t);for(var o=0;o<r.length;o+=1)e[r[o]]=t[r[o]]}return e},xml2str:function(e){return(new a).serializeToString(e).replace(/xmlns(:[a-z0-9]+)?="" ?/g,"")},str2xml:function(e){return(new o).parseFromString(e,"text/xml")},getRight:function(e,t,r){for(var n=r,o=e.length;n<o;n++)if(e[n].value==="</"+t+">")return n;i({position:"right",element:t,parsed:e,index:r})},getLeft:function(e,t,r){for(var n=r;n>=0;n--){var o=e[n];if(0===o.value.indexOf("<"+t)&&-1!==[">"," "].indexOf(o.value[t.length+1]))return n}i({position:"left",element:t,parsed:e,index:r})},pregMatchAll:function(e,t){for(var r=[],n=void 0;null!=(n=e.exec(t));)r.push({array:n,offset:n.index});return r},convertSpaces:function(e){return e.replace(h," ")},escapeRegExp:c,charMapRegexes:f,hasCorruptCharacters:function(e){return v.test(e)},defaults:u,wordToUtf8:function(e){for(var t=void 0,r=0,n=f.length;r<n;r++)t=f[r],e=e.replace(t.rstart,t.end);return e},utf8ToWord:function(e){"string"!=typeof e&&(e=e.toString());for(var t=void 0,r=0,n=f.length;r<n;r++)t=f[r],e=e.replace(t.rend,t.start);return e},concatArrays:function(e){for(var t=[],r=0;r<e.length;r++)for(var n=e[r],o=0,a=n.length;o<a;o++)t.push(n[o]);return t},charMap:l}},function(e,t,r){"use strict";var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function o(e){this.name="GenericError",this.message=e,this.stack=new Error(e).stack}function a(e){this.name="TemplateError",this.message=e,this.stack=new Error(e).stack}function i(e){this.name="RenderingError",this.message=e,this.stack=new Error(e).stack}function s(e){this.name="ScopeParserError",this.message=e,this.stack=new Error(e).stack}function u(e){this.name="InternalError",this.properties={explanation:"InternalError"},this.message=e,this.stack=new Error(e).stack}function l(e){this.name="APIVersionError",this.properties={explanation:"APIVersionError"},this.message=e,this.stack=new Error(e).stack}o.prototype=Error.prototype,a.prototype=new o,i.prototype=new o,s.prototype=new o,u.prototype=new o,l.prototype=new o,e.exports={XTError:o,XTTemplateError:a,XTInternalError:u,XTScopeParserError:s,XTAPIVersionError:l,RenderingError:i,getClosingTagNotMatchOpeningTag:function(e){var t=e.tags,r=new a("Closing tag does not match opening tag");return r.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'+t[0].value+'" is closed by the tag "'+t[1].value+'"',openingtag:t[0].value,offset:[t[0].offset,t[1].offset],closingtag:t[1].value},r},getLoopPositionProducesInvalidXMLError:function(e){var t=e.tag,r=new a('The position of the loop tags "'+t+'" would produce invalid XML');return r.properties={tag:t,id:"loop_position_invalid",explanation:'The tags "'+t+'" are misplaced in the document, for example one of them is in a table and the other one outside the table'},r},getScopeCompilationError:function(e){var t=e.tag,r=e.rootError,n=new s("Scope parser compilation failed");return n.properties={id:"scopeparser_compilation_failed",tag:t,explanation:'The scope parser for the tag "'+t+'" failed to compile',rootError:r},n},getScopeParserExecutionError:function(e){var t=e.tag,r=e.scope,n=e.error,o=new s("Scope parser execution failed");return o.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag "+t+" failed to execute",scope:r,tag:t,rootError:n},o},getUnclosedTagException:function(e){var t=new a("Unclosed tag");return t.properties={xtag:function(e){return e[0]}(e.xtag.split(" ")).substr(1),id:"unclosed_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'+e.xtag.substr(0,10)+'" is unclosed'},t},getUnmatchedLoopException:function(e){var t=e.location,r="start"===t?"unclosed":"unopened",n=new a(("start"===t?"Unclosed":"Unopened")+" loop"),o=e.part.value;return n.properties={id:r+"_loop",explanation:'The loop with tag "'+o+'" is '+r,xtag:o},n},getUnopenedTagException:function(e){var t=new a("Unopened tag");return t.properties={xtag:function(e){return e[e.length-1]}(e.xtag.split(" ")),id:"unopened_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'+e.xtag.substr(0,10)+'" is unopened'},t},throwApiVersionError:function(e,t){var r=new l(e);throw r.properties=n({id:"api_version_error"},t),r},throwContentMustBeString:function(e){var t=new u("Content must be a string");throw t.properties.id="xmltemplater_content_must_be_string",t.properties.type=e,t},throwCorruptCharacters:function(e){var t=e.tag,r=e.value,n=new i("There are some XML corrupt characters");throw n.properties={id:"invalid_xml_characters",xtag:t,value:r,explanation:"There are some corrupt characters for the field ${tag}"},n},throwFileTypeNotHandled:function(e){var t=new u('The filetype "'+e+'" is not handled by docxtemplater');throw t.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'+e+'", but only docx and pptx formats are handled',fileType:e},t},throwFileTypeNotIdentified:function(){var e=new u("The filetype for this file could not be identified, is this file corrupted ?");throw e.properties={id:"filetype_not_identified"},e},throwLocationInvalid:function(e){throw new u('Location should be one of "start" or "end" (given : '+e.location+")")},throwMalformedXml:function(e){var t=new u("Malformed xml");throw t.properties={part:e,id:"malformed_xml"},t},throwMultiError:function(e){var t=new a("Multi error");throw t.properties={errors:e,id:"multi_error",explanation:"The template has multiple errors"},t},throwRawTagNotInParagraph:function(e){var t=new a("Raw tag not in paragraph"),r=e.part,n=r.value,o=r.offset;throw t.properties={id:"raw_tag_outerxml_invalid",explanation:'The tag "'+n+'" is not inside a paragraph',rootError:e.rootError,xtag:n,offset:o,postparsed:e.postparsed,expandTo:e.expandTo,index:e.index},t},throwRawTagShouldBeOnlyTextInParagraph:function(e){var t=new a("Raw tag should be the only text in paragraph"),r=e.part.value;throw t.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The raw tag "'+r+'" should be the only text in this paragraph. This means that this tag should not be surrounded by any text or spaces.',xtag:r,offset:e.part.offset,paragraphParts:e.paragraphParts},t},throwUnimplementedTagType:function(e){var t=new a('Unimplemented tag type "'+e.type+'"');throw t.properties={part:e,id:"unimplemented_tag_type"},t},throwXmlTagNotFound:function(e){var t=new a('No tag "'+e.element+'" was found at the '+e.position);throw t.properties={id:"no_xml_tag_found_at_"+e.position,explanation:'No tag "'+e.element+'" was found at the '+e.position,part:e.parsed[e.index],parsed:e.parsed,index:e.index,element:e.element},t},throwXmlInvalid:function(e,t){var r=new a("An XML file has invalid xml");throw r.properties={id:"file_has_invalid_xml",content:e,offset:t,explanation:"The docx contains invalid XML, it is most likely corrupt"},r}}},function(e,t,r){"use strict";function n(){}function o(e){return e}e.exports=function(e){var t={set:n,parse:n,render:n,getTraits:n,nullGetter:n,optionsTransformer:o,postrender:o,errorsTransformer:o,getRenderedMap:o,postparse:o,on:n,resolve:n};if(Object.keys(t).every(function(t){return!e[t]}))throw new Error("This module cannot be wrapped, because it doesn't define any of the necessary functions");return Object.keys(t).forEach(function(r){e[r]=e[r]||t[r]}),e}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(0),a=o.getRight,i=o.getLeft,s=o.concatArrays,u=o.chunkBy,l=o.isTagStart,p=o.isTagEnd,c=o.isContent,f=o.last,h=r(1),d=h.XTTemplateError,g=h.throwRawTagNotInParagraph,v=h.getLoopPositionProducesInvalidXMLError;function m(e,t){if(0===e.length)return!1;var r=e[e.length-1].tag.substr(1),n=t.substr(2,t.length-3);return 0===r.indexOf(n)}function y(e,t){return e.push({tag:t}),e}e.exports={expandToOne:function(e,t){var r=[];return e.errors&&(r=e.errors,e=e.postparsed),e.reduce(function(e,r){return"placeholder"===r.type&&r.module===t.moduleName&&e.push(r),e},[]).forEach(function(n){try{e=function(e,t,r){var n=e.expandTo||r.expandTo,o=t.indexOf(e);if(!n)return t;var u=void 0,l=void 0;try{u=a(t,n,o),l=i(t,n,o)}catch(r){throw r instanceof d&&g({part:e,rootError:r,postparsed:t,expandTo:n,index:o}),r}var p=t.slice(l,o),c=t.slice(o+1,u+1),f=r.getInner({index:o,part:e,leftParts:p,rightParts:c,left:l,right:u,postparsed:t});return f.length||(f.expanded=[p,c],f=[f]),s([t.slice(0,l),f,t.slice(u+1)])}(n,e,t)}catch(e){if(!(e instanceof d))throw e;r.push(e)}}),{postparsed:e,errors:r}},getExpandToDefault:function(e,t,r){var o=function(e){for(var t,r=e.filter(function(e){return"tag"===e.type}),n=[],o=0;o<r.length;o++)"/"===(t=r[o].value)[1]?m(n,t)?n.pop():n=y(n,t):"/"!==t[t.length-2]&&(n=y(n,t));return n}(e.slice(t[0].offset,t[1].offset));if(o.filter(function(e){return"/"===e.tag[1]}).length!==o.filter(function(e){var t=e.tag;return"/"!==t[1]&&"/"!==t[t.length-2]}).length)return{error:v({tag:t[0].part.value})};for(var s=function(n,s){var h=r[n],d=h.contains,g=h.expand,v=h.onlyTextInTag;if(function(e,t){for(var r=0;r<t.length;r++)if(0===t[r].tag.indexOf("<"+e))return!0;return!1}(d,o)){if(v){var m=i(e,d,t[0].offset),y=a(e,d,t[1].offset),x=u(e.slice(m,y),function(e){return l(d,e)?"start":p(d,e)?"end":null});if(x.length<=2)return"continue";var w=x[0],T=f(x),b=w.filter(c),P=T.filter(c);if(1!==b.length||1!==P.length)return"continue"}return{v:{value:g}}}},h=0,d=r.length;h<d;h++){var g=s(h);switch(g){case"continue":continue;default:if("object"===(void 0===g?"undefined":n(g)))return g.v}}return!1}}},function(e,t,r){"use strict";var n=r(0).pregMatchAll;e.exports=function(e,t){var r={};r.content=e,r.tagsXmlArray=t,r.tagsXmlArrayJoined=r.tagsXmlArray.join("|");var o=new RegExp("(?:(<(?:"+r.tagsXmlArrayJoined+")[^>]*>)([^<>]*)</(?:"+r.tagsXmlArrayJoined+")>)|(<(?:"+r.tagsXmlArrayJoined+")[^>]*/>)","g");return r.matches=n(o,r.content),function(e){function t(){var t={array:Array.prototype.slice.call(arguments)};t.array.shift();var r=t.array[0]+t.array[1];t.array.unshift(r),t.array.pop();var n=t.array.pop();t.offset=n,t.first=!0,e.matches.unshift(t)}-1===e.content.indexOf("<")&&-1===e.content.indexOf(">")&&e.content.replace(/^()([^<>]*)$/,t);var r=new RegExp("^()([^<]+)</(?:"+e.tagsXmlArrayJoined+")>");return e.content.replace(r,t),r=new RegExp("(<(?:"+e.tagsXmlArrayJoined+")[^>]*>)([^>]+)$"),e.content.replace(r,function(){var t={array:Array.prototype.slice.call(arguments)};t.array.pop();var r=t.array.pop();t.offset=r,t.last=!0,-1===t.array[0].indexOf("/>")&&e.matches.push(t)}),e}(r)}},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=r(0);o.traits=r(3),o.moduleWrapper=r(2);var a=o.defaults,i=o.str2xml,s=o.xml2str,u=o.moduleWrapper,l=o.utf8ToWord,p=o.concatArrays,c=o.unique,f=r(1),h=f.XTInternalError,d=f.throwFileTypeNotIdentified,g=f.throwFileTypeNotHandled,v=f.throwApiVersionError,m=[3,6,0],y=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),arguments.length>0)throw new Error("The constructor with parameters has been removed in docxtemplater 3, please check the upgrade guide.");this.compiled={},this.modules=[],this.setOptions({})}return n(e,[{key:"getModuleApiVersion",value:function(){return m.join(".")}},{key:"verifyApiVersion",value:function(e){return 3!==(e=e.split(".").map(function(e){return parseInt(e,10)})).length&&v("neededVersion is not a valid version",{neededVersion:e,explanation:"the neededVersion must be an array of length 3"}),e[0]!==m[0]&&v("The major api version do not match",{neededVersion:e,currentModuleApiVersion:m,explanation:"moduleAPIVersionMismatch : needed="+e.join(".")+", current="+m.join(".")}),e[1]>m[1]&&v("The minor api version is not uptodate",{neededVersion:e,currentModuleApiVersion:m,explanation:"moduleAPIVersionMismatch : needed="+e.join(".")+", current="+m.join(".")}),!0}},{key:"setModules",value:function(e){this.modules.forEach(function(t){t.set(e)})}},{key:"sendEvent",value:function(e){this.modules.forEach(function(t){t.on(e)})}},{key:"attachModule",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).prefix;return t&&(e.prefix=t),this.modules.push(u(e)),this}},{key:"setOptions",value:function(e){var t=this;return e.delimiters&&(e.delimiters.start=l(e.delimiters.start),e.delimiters.end=l(e.delimiters.end)),this.options=e,Object.keys(a).forEach(function(e){var r=a[e];t.options[e]=null!=t.options[e]?t.options[e]:r,t[e]=t.options[e]}),this.zip&&this.updateFileTypeConfig(),this}},{key:"loadZip",value:function(e){if(e.loadAsync)throw new h("Docxtemplater doesn't handle JSZip version >=3, see changelog");return this.zip=e,this.updateFileTypeConfig(),this.modules=p([this.fileTypeConfig.baseModules.map(function(e){return e()}),this.modules]),this}},{key:"compileFile",value:function(e){var t=this.createTemplateClass(e);t.parse(),this.compiled[e]=t}},{key:"resolveData",value:function(e){var t=this;return Promise.all(Object.keys(this.compiled).map(function(r){return t.compiled[r].resolveTags(e)})).then(function(e){return p(e)})}},{key:"compile",value:function(){var e=this;return Object.keys(this.compiled).length?this:(this.options=this.modules.reduce(function(t,r){return r.optionsTransformer(t,e)},this.options),this.options.xmlFileNames=c(this.options.xmlFileNames),this.xmlDocuments=this.options.xmlFileNames.reduce(function(t,r){var n=e.zip.files[r].asText();return t[r]=i(n),t},{}),this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments}),this.getTemplatedFiles(),this.setModules({compiled:this.compiled}),this.templatedFiles.forEach(function(t){null!=e.zip.files[t]&&e.compileFile(t)}),this)}},{key:"updateFileTypeConfig",value:function(){var t=void 0;return this.zip.files.mimetype&&(t="odt"),(this.zip.files["word/document.xml"]||this.zip.files["word/document2.xml"])&&(t="docx"),this.zip.files["ppt/presentation.xml"]&&(t="pptx"),"odt"===t&&g(t),t||d(),this.fileType=t,this.fileTypeConfig=this.options.fileTypeConfig||e.FileTypeConfig[this.fileType],this}},{key:"render",value:function(){var e=this;return this.compile(),this.setModules({data:this.data}),this.mapper=this.modules.reduce(function(e,t){return t.getRenderedMap(e)},{}),this.fileTypeConfig.tagsXmlLexedArray=c(this.fileTypeConfig.tagsXmlLexedArray),this.fileTypeConfig.tagsXmlTextArray=c(this.fileTypeConfig.tagsXmlTextArray),Object.keys(this.mapper).forEach(function(t){var r=e.mapper[t],n=r.from,o=r.data,a=e.compiled[n];a.setTags(o),a.render(t),e.zip.file(t,a.content,{createFolders:!0})}),this.sendEvent("syncing-zip"),this.syncZip(),this}},{key:"syncZip",value:function(){var e=this;Object.keys(this.xmlDocuments).forEach(function(t){e.zip.remove(t);var r=s(e.xmlDocuments[t]);return e.zip.file(t,r,{createFolders:!0})})}},{key:"setData",value:function(e){return this.data=e,this}},{key:"getZip",value:function(){return this.zip}},{key:"createTemplateClass",value:function(e){var t=this.zip.files[e].asText();return this.createTemplateClassFromContent(t,e)}},{key:"createTemplateClassFromContent",value:function(t,r){var n=this,o={filePath:r};return Object.keys(a).forEach(function(e){o[e]=n[e]}),o.fileTypeConfig=this.fileTypeConfig,o.modules=this.modules,new e.XmlTemplater(t,o)}},{key:"getFullText",value:function(e){return this.createTemplateClass(e||this.fileTypeConfig.textPath(this.zip)).getFullText()}},{key:"getTemplatedFiles",value:function(){return this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip),this.templatedFiles}}]),e}();y.DocUtils=o,y.Errors=r(1),y.XmlTemplater=r(7),y.FileTypeConfig=r(14),y.XmlMatcher=r(4),e.exports=y},function(e,t,r){"use strict";e.exports=window},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var a=r(0),i=a.wordToUtf8,s=a.convertSpaces,u=a.defaults,l=r(8),p=r(4),c=r(1),f=c.throwMultiError,h=c.throwContentMustBeString,d=r(9),g=r(10),v=r(11),m=r(12),y=r(13);e.exports=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.filePath=r.filePath,this.modules=r.modules,this.fileTypeConfig=r.fileTypeConfig,Object.keys(u).map(function(e){this[e]=null!=r[e]?r[e]:u[e]},this),this.setModules({inspect:{filePath:this.filePath}}),this.load(t)}return o(e,[{key:"load",value:function(e){"string"!=typeof e&&h(void 0===e?"undefined":n(e)),this.content=e}},{key:"setTags",value:function(e){return this.tags=null!=e?e:{},this.scopeManager=l({tags:this.tags,parser:this.parser}),this}},{key:"resolveTags",value:function(e){var t=this;this.tags=null!=e?e:{},this.scopeManager=l({tags:this.tags,parser:this.parser});var r=this.getOptions();return r.scopeManager=l(r),r.resolve=y,y(r).then(function(e){var r=e.resolved;return Promise.all(r.map(function(e){return Promise.resolve(e)})).then(function(e){return t.resolved=e})})}},{key:"getFullText",value:function(){return function(e,t){var r=p(e,t).matches.map(function(e){return e.array[2]});return i(s(r.join("")))}(this.content,this.fileTypeConfig.tagsXmlTextArray)}},{key:"setModules",value:function(e){this.modules.forEach(function(t){t.set(e)})}},{key:"parse",value:function(){var e=[];this.xmllexed=d.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray}),this.setModules({inspect:{xmllexed:this.xmllexed}});var t=d.parse(this.xmllexed,this.delimiters),r=t.lexed,n=t.errors;e=e.concat(n),this.lexed=r,this.setModules({inspect:{lexed:this.lexed}}),this.parsed=g.parse(this.lexed,this.modules),this.setModules({inspect:{parsed:this.parsed}});var o=g.postparse(this.parsed,this.modules),a=o.postparsed,i=o.errors;return this.postparsed=a,this.setModules({inspect:{postparsed:this.postparsed}}),e=e.concat(i),this.errorChecker(e),this}},{key:"errorChecker",value:function(e){var t=this;e.length&&(this.modules.forEach(function(t){e=t.errorsTransformer(e)}),e.forEach(function(e){e.properties.file=t.filePath}),f(e))}},{key:"baseNullGetter",value:function(e,t){var r=this,n=this.modules.reduce(function(n,o){return null!=n?n:o.nullGetter(e,t,r)},null);return null!=n?n:this.nullGetter(e,t)}},{key:"getOptions",value:function(){return{compiled:this.postparsed,tags:this.tags,modules:this.modules,parser:this.parser,baseNullGetter:this.baseNullGetter.bind(this),filePath:this.filePath,linebreaks:this.linebreaks}}},{key:"render",value:function(e){this.filePath=e;var t=this.getOptions();t.resolved=this.resolved,t.scopeManager=l(t),t.render=v;var r=v(t),n=r.errors,o=r.parts;return this.errorChecker(n),this.content=m(o,t),this.setModules({inspect:{content:this.content}}),this}}]),e}()},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=r(1).getScopeParserExecutionError;function a(e,t){for(var r=e.length>>>0,n=void 0,o=0;o<r;o++)if(n=e[o],t.call(this,n,o,e))return n}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scopePath=t.scopePath,this.scopePathItem=t.scopePathItem,this.scopeList=t.scopeList,this.parser=t.parser,this.resolved=t.resolved}return n(e,[{key:"loopOver",value:function(e,t,r,n){return r=r||!1,this.loopOverValue(this.getValue(e,n),t,r)}},{key:"functorIfInverted",value:function(e,t,r,n){e&&t(r,n)}},{key:"isValueFalsy",value:function(e,t){return null==e||!e||"[object Array]"===t&&0===e.length}},{key:"loopOverValue",value:function(e,t,r){var n=Object.prototype.toString.call(e),o=this.scopeList[this.num];if(this.isValueFalsy(e,n))return this.functorIfInverted(r,t,o,0);if("[object Array]"!==n)return"[object Object]"===n?this.functorIfInverted(!r,t,e,0):this.functorIfInverted(!r,t,o,0);for(var a,i=0;i<e.length;i++)a=e[i],this.functorIfInverted(!r,t,a,i)}},{key:"getValue",value:function(e,t){var r=this.scopeList.length-1;return function e(t,r,n){var i=this;this.num=n;var s=this.scopeList[this.num];if(this.resolved){var u=this.resolved;return this.scopePath.forEach(function(e,t){u=(u=a(u,function(t){return t.tag===e})).value[i.scopePathItem[t]]}),a(u,function(e){return e.tag===t}).value}var l=void 0,p=this.parser(t,{scopePath:this.scopePath});try{l=p.get(s,this.getContext(r))}catch(e){throw o({tag:t,scope:s,error:e})}return null==l&&this.num>0?e.call(this,t,r,this.num-1):l}.call(this,e,t,r)}},{key:"getValueAsync",value:function(e,t){var r=this.scopeList.length-1;return function e(t,r,n){var a=this;this.num=n;var i=this.scopeList[this.num],s=this.parser(t,{scopePath:this.scopePath});return Promise.resolve(s.get(i,this.getContext(r))).catch(function(e){throw o({tag:t,scope:i,error:e})}).then(function(n){return null==n&&a.num>0?e.call(a,t,r,a.num-1):n})}.call(this,e,t,r)}},{key:"getContext",value:function(e){return{num:this.num,meta:e,scopeList:this.scopeList,resolved:this.resolved,scopePath:this.scopePath,scopePathItem:this.scopePathItem}}},{key:"createSubScopeManager",value:function(t,r,n){return new e({resolved:this.resolved,parser:this.parser,scopeList:this.scopeList.concat(t),scopePath:this.scopePath.concat(r),scopePathItem:this.scopePathItem.concat(n)})}}]),e}();e.exports=function(e){return e.scopePath=[],e.scopePathItem=[],e.scopeList=[e.tags],new i(e)}},function(e,t,r){"use strict";var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=r(1),a=o.getUnclosedTagException,i=o.getUnopenedTagException,s=o.throwMalformedXml,u=o.throwXmlInvalid,l=r(0),p=l.concatArrays,c=l.isTextStart,f=l.isTextEnd,h=0,d=-1,g=1;function v(e,t){return e[0]<=t.offset&&t.offset<e[1]}function m(e,t){return c(e)?(t&&s(e),!0):f(e)?(t||s(e),!1):t}function y(e){var t="start",r=1;"/"===e[e.length-2]&&(t="selfclosing"),"/"===e[1]&&(r=2,t="end");var n=e.indexOf(" "),o=-1===n?e.length-1:n;return{tag:e.slice(r,o),position:t}}function x(e,t){return e===t?h:-1===e||-1===t?t<e?d:g:e<t?d:g}function w(e){var t=e.split(" ");if(2!==t.length)throw new Error("New Delimiters cannot be parsed");var r=n(t,2),o=r[0],a=r[1];if(0===o.length||0===a.length)throw new Error("New Delimiters cannot be parsed");return[o,a]}function T(e){var t=this;this.innerContentParts=e,this.full="",this.parseDelimiters=function(e){t.full=t.innerContentParts.map(function(e){return e.value}).join("");var r=function(e,t){for(var r=[],o=t.start,a=t.end,i=-1;;){var s=e.indexOf(o,i+1),u=e.indexOf(a,i+1),l=null,p=void 0,c=x(s,u);if(c===h)return r;if(c===g&&(i=u,l="end",p=a.length),c===d&&(i=s,l="start",p=o.length),"start"!==l||"="!==e[i+o.length])r.push({offset:i,position:l,length:p});else{r.push({offset:s,position:"start",length:o.length,changedelimiter:!0});var f=e.indexOf("=",i+o.length+1),v=e.indexOf(a,f+1);r.push({offset:v,position:"end",length:a.length,changedelimiter:!0});var m=w(e.substr(i+o.length+1,f-i-o.length-1)),y=n(m,2);o=y[0],a=y[1],i=v}}}(t.full,e),o=0,s=t.innerContentParts.map(function(e){return{offset:(o+=e.value.length)-e.value.length,lIndex:e.lIndex}}),u=function(e,t,r){if(0===e.length)return[];var n=[],o=!1,s={offset:0},u=void 0,l=0;e.forEach(function(e){for(;r[l+1]&&!(r[l+1].offset>e.offset);)l++;u=t.substr(s.offset,e.offset-s.offset),"start"===e.position&&o||"end"===e.position&&!o?"start"===e.position?(n.push(a({xtag:u,offset:s.offset})),e.error=!0):(n.push(i({xtag:u,offset:e.offset})),e.error=!0):o=!o,s=e});var p={offset:t.length};return u=t.substr(s.offset,p.offset-s.offset),o&&(n.push(a({xtag:u,offset:s.offset})),p.error=!0),n}(r,t.full,s),l=0,p=0;t.parsed=s.map(function(e,t){for(var n=e.offset,o=[n,n+this.innerContentParts[t].value.length],a=this.innerContentParts[t].value,i=[];p<r.length&&v(o,r[p]);)i.push(r[p]),p++;var s=[],u=0;l>0&&(u=l,l=0);var c=void 0;i.forEach(function(e){var t=a.substr(u,e.offset-n-u);if(t.length>0){if(c)return void(e.changedelimiter&&(u=e.offset-n+e.length,c="start"===e.position));s.push({type:"content",value:t,offset:u+n}),u+=t.length}var r={type:"delimiter",position:e.position,offset:u+n};if(e.error&&(r.error=e.error),e.changedelimiter)return c="start"===e.position,void(u=e.offset-n+e.length);s.push(r),u=e.offset-n+e.length}),l=u-a.length;var f=a.substr(u);return f.length>0&&s.push({type:"content",value:f,offset:n}),s},t),t.errors=u}}e.exports={parse:function(e,t){var r=!1,n=new T(function(e){var t=!1,r=[];return e.forEach(function(e){(t=m(e,t))&&"content"===e.type&&r.push(e)}),r}(e));n.parseDelimiters(t);var o=[],a=0;return e.forEach(function(e){r=m(e,r),"content"===e.type&&(e.position=r?"insidetag":"outsidetag"),r&&"content"===e.type?(Array.prototype.push.apply(o,n.parsed[a].map(function(e){return"content"===e.type&&(e.position="insidetag"),e})),a++):o.push(e)}),o=o.map(function(e,t){return e.lIndex=t,e}),{errors:n.errors,lexed:o}},xmlparse:function(e,t){var r=function(e,t,r){for(var n=0,o=e.length,a=p([t.map(function(e){return{tag:e,text:!0}}),r.map(function(e){return{tag:e,text:!1}})]).reduce(function(e,t){return e[t.tag]=t.text,e},{}),i=[];n<o&&-1!==(n=e.indexOf("<",n));){var s=n,l=e.indexOf("<",n+1);(-1===(n=e.indexOf(">",n))||-1!==l&&n>l)&&u(e,s);var c=e.slice(s,n+1),f=y(c),h=f.tag,d=f.position,g=a[h];null!=g&&i.push({type:"tag",position:d,text:g,offset:s,value:c,tag:h})}return i}(e,t.text,t.other),n=0,o=r.reduce(function(t,r){var o=e.substr(n,r.offset-n);return o.length>0&&t.push({type:"content",value:o}),n=r.offset+r.value.length,delete r.offset,r.value.length>0&&t.push(r),t},[]),a=e.substr(n);return a.length>0&&o.push({type:"content",value:a}),o}}},function(e,t,r){"use strict";var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=r(0),a=o.wordToUtf8,i=o.concatArrays;var s={postparse:function(e,t){function r(e,r){return t.map(function(t){return t.getTraits(e,r)})}var o=[];function a(e,s){return t.reduce(function(e,t){var u=t.postparse(e,n({},s,{postparse:a,getTraits:r}));return u.errors?(o=i([o,u.errors]),u.postparsed):u},e)}return{postparsed:a(e),errors:o}},parse:function(e,t){var r=!1,n="",o=void 0,i=[];return e.reduce(function(e,s){if("delimiter"===s.type){if(r="start"===s.position,"end"===s.position){var u=s.lIndex;n=a(n),e=function(e,t,r,n,o){for(var a=void 0,i=0,s=e.length;i<s;i++)if(a=e[i].parse(t))return a.offset=n,a.endLindex=o,a.lIndex=o,r.push(a),r;return r.push({type:"placeholder",value:t,offset:n,endLindex:o,lIndex:o}),r}(t,n,e,o,u),o=null,Array.prototype.push.apply(e,i),i=[]}return"start"===s.position&&(i=[],o=s.offset),n="",e}return r?"content"!==s.type||"insidetag"!==s.position?(i.push(s),e):(n+=s.value,e):(e.push(s),e)},[])}};e.exports=s},function(e,t,r){"use strict";var n=r(0).concatArrays,o=r(1).throwUnimplementedTagType;e.exports=function(e){var t=e.baseNullGetter,r=e.compiled,a=e.scopeManager;e.nullGetter=function(e,r){return t(e,r||a)};var i=[],s=r.map(function(t){var r=function(e,t){for(var r=void 0,n=0,o=t.modules.length;n<o;n++)if(r=t.modules[n].render(e,t))return r;return!1}(t,e);return r?(r.errors&&(i=n([i,r.errors])),r.value):"content"===t.type||"tag"===t.type?t.value:void o(t)});return{errors:i,parts:s}}},function(e,t,r){"use strict";e.exports=function(e,t){for(var r=0,n=t.modules.length;r<n;r++)e=t.modules[r].postrender(e,t);return e.join("")}},function(e,t,r){"use strict";e.exports=function(e){var t=[],r=e.baseNullGetter,n=e.compiled,o=e.scopeManager;e.nullGetter=function(e,t){return r(e,t||o)},e.resolved=t;var a=[];return Promise.all(n.map(function(r){var n=function(e,t){for(var r=void 0,n=0,o=t.modules.length;n<o;n++)if(r=t.modules[n].resolve(e,t))return r;return!1}(r,e);return n?n.then(function(e){t.push({tag:r.value,value:e})}):"placeholder"===r.type?o.getValueAsync(r.value,{part:r}).then(function(n){return null==n&&(n=e.nullGetter(r)),t.push({tag:r.value,value:n}),n}):void 0}).filter(function(e){return e})).then(function(){return{errors:a,resolved:t}})}},function(e,t,r){"use strict";var n=r(15),o=r(16),a=r(17),i=r(18),s=r(20),u={getTemplatedFiles:function(e){return e.file(/ppt\/(slides|slideMasters)\/(slide|slideMaster)\d+\.xml/).map(function(e){return e.name}).concat(["ppt/presentation.xml","docProps/app.xml","docProps/core.xml"])},textPath:function(){return"ppt/slides/slide1.xml"},tagsXmlTextArray:["a:t","m:t","vt:lpstr","dc:title","dc:creator","cp:keywords"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:table","a:p","a:r","a:rPr"],expandTags:[{contains:"a:tc",expand:"a:tr"}],onParagraphLoop:[{contains:"a:p",expand:"a:p",onlyTextInTag:!0}],tagRawXml:"p:sp",tagTextXml:"a:t",baseModules:[n,i,a,s]},l={getTemplatedFiles:function(e){return e.file(/word\/(header|footer)\d+\.xml/).map(function(e){return e.name}).concat(["docProps/core.xml","docProps/app.xml","word/document.xml","word/document2.xml"])},textPath:function(e){return e.files["word/document.xml"]?"word/document.xml":e.files["word/document2.xml"]?"word/document2.xml":void 0},tagsXmlTextArray:["w:t","m:t","vt:lpstr","dc:title","dc:creator","cp:keywords"],tagsXmlLexedArray:["w:tc","w:tr","w:table","w:p","w:r","w:rPr","w:pPr","w:spacing"],expandTags:[{contains:"w:tc",expand:"w:tr"}],onParagraphLoop:[{contains:"w:p",expand:"w:p",onlyTextInTag:!0}],tagRawXml:"w:p",tagTextXml:"w:t",baseModules:[n,o,i,a,s]};e.exports={docx:l,pptx:u}},function(e,t,r){"use strict";var n=r(0),o=n.mergeObjects,a=n.chunkBy,i=n.last,s=n.isParagraphStart,u=n.isParagraphEnd,l=n.isContent,p=/^-([^\s]+)\s(.+)$/,c=r(2);function f(e){return function(e){return e.some(function(e){return l(e)})}(e)?0:e.length}var h={name:"LoopModule",prefix:{start:"#",end:"/",dash:"-",inverted:"^"},parse:function(e){var t="placeholder",r=this.prefix,n=r.start,o=r.inverted,a=r.dash,i=r.end;return e[0]===n?{type:t,value:e.substr(1),expandTo:"auto",module:"loop",location:"start",inverted:!1}:e[0]===o?{type:t,value:e.substr(1),expandTo:"auto",module:"loop",location:"start",inverted:!0}:e[0]===i?{type:t,value:e.substr(1),module:"loop",location:"end"}:e[0]===a?{type:t,value:e.replace(p,"$2"),expandTo:e.replace(p,"$1"),module:"loop",location:"start",inverted:!1}:null},getTraits:function(e,t){if("expandPair"===e)return t.reduce(function(e,t,r){return"placeholder"===t.type&&"loop"===t.module&&e.push({part:t,offset:r}),e},[])},postparse:function(e,t){var r=t.basePart;if(!function(e){return 0!==e.length&&s(e[0])&&u(i(e))}(e))return e;if(!r||"auto"!==r.expandTo||"loop"!==r.module)return e;var n=a(e,function(e){return s(e)?"start":u(e)?"end":null});if(n.length<=2)return e;var o=n[0],l=i(n),p=f(o),c=f(l);return 0===p||0===c?e:e.slice(p,e.length-c)},render:function(e,t){if("placeholder"===!e.type||"loop"!==e.module)return null;var r=[],n=[];return t.scopeManager.loopOver(e.value,function(a,i){var s=t.scopeManager.createSubScopeManager(a,e.value,i),u=t.render(o({},t,{compiled:e.subparsed,tags:{},scopeManager:s}));r=r.concat(u.parts),n=n.concat(u.errors||[])},e.inverted,{part:e}),{value:r.join(""),errors:n}},resolve:function(e,t){if("placeholder"===!e.type||"loop"!==e.module)return null;var r=t.scopeManager.getValue(e.value,{part:e}),n=[];function a(r,a){var i=t.scopeManager.createSubScopeManager(r,e.value,a);n.push(t.resolve(o(t,{compiled:e.subparsed,tags:{},scopeManager:i})))}return Promise.resolve(r).then(function(r){return t.scopeManager.loopOverValue(r,a,e.inverted),Promise.all(n).then(function(e){return e.map(function(e){return e.resolved})})})}};e.exports=function(){return c(h)}},function(e,t,r){"use strict";var n=r(2),o=r(0),a=o.isTextStart,i=o.isTextEnd,s=o.endsWith,u=o.startsWith,l='<w:t xml:space="preserve">'.length,p="</w:t>".length;function c(e,t){var r=e[t].value;return"</w:t>"===e[t+1].value?r:-1!==r.indexOf('xml:space="preserve"')?r:r.substr(0,r.length-1)+' xml:space="preserve">'}var f={name:"SpacePreserveModule",postparse:function(e,t){var r=[],n=!1,o=0,s=0;var u=e.reduce(function(e,u){return function(e){return a(e)&&"w:t"===e.tag}(u)&&(n=!0,s=r.length),n?(r.push(u),function(e,t){return e&&e.basePart&&t.length>1}(t,r)&&(o=t.basePart.endLindex,r[0].value=c(r,0)),function(e,t){return!o&&"placeholder"===e.type&&(!e.module||"loop"===e.module)&&t.length>1}(u,r)&&(o=u.endLindex,r[0].value=c(r,0)),i(u)&&u.lIndex>o&&(0!==o&&(r[s].value=c(r,s)),Array.prototype.push.apply(e,r),r=[],n=!1,o=0,s=0),e):(e.push(u),e)},[]);return Array.prototype.push.apply(u,r),u},postrender:function(e){return e.filter(function(e){return 0!==e.length}).reduce(function(e,t,r,n){return-1!==t.indexOf('<w:t xml:space="preserve"></w:t>')&&(t=t.replace(/<w:t xml:space="preserve"><\/w:t>/g,"<w:t/>")),s(t,'<w:t xml:space="preserve">')&&u(n[r+1],"</w:t>")&&(t=t.substr(0,t.length-l)+"<w:t/>",n[r+1]=n[r+1].substr(p)),e.push(t),e},[])}};e.exports=function(){return n(f)}},function(e,t,r){"use strict";var n=r(3),o=r(0).isContent,a=r(1).throwRawTagShouldBeOnlyTextInParagraph,i=r(2);function s(e){var t=e.part,r=e.left,n=e.right,i=e.postparsed,s=e.index,u=function(e,t,r){for(var n=r;n>=0;n--)for(var o=e[n],a=0,i=t.length;a<i;a++){var s=t[a];if(0===o.value.indexOf("<"+s)&&-1!==[">"," "].indexOf(o.value[s.length+1]))return t[a]}return null}(i,["w:p","w:tc"],r-1);"w:tc"===function(e,t,r){for(var n=r,o=e.length;n<o;n++)for(var a=e[n],i=0,s=t.length;i<s;i++){var u=t[i];if(a.value==="</"+u+">")return t[i]}return-1}(i,["w:p","w:tc"],n+1)&&"w:tc"===u&&(t.emptyValue="<w:p></w:p>");var l=i.slice(r+1,n);return l.forEach(function(e,n){n!==s-r-1&&o(e)&&a({paragraphParts:l,part:t})}),t}var u={name:"RawXmlModule",prefix:"@",optionsTransformer:function(e,t){return this.fileTypeConfig=t.fileTypeConfig,e},parse:function(e){return e[0]!==this.prefix?null:{type:"placeholder",value:e.substr(1),module:"rawxml"}},postparse:function(e){return n.expandToOne(e,{moduleName:"rawxml",getInner:s,expandTo:this.fileTypeConfig.tagRawXml})},render:function(e,t){if("rawxml"!==e.module)return null;var r=t.scopeManager.getValue(e.value,{part:e});return null==r&&(r=t.nullGetter(e)),r?{value:r}:{value:e.emptyValue||""}},resolve:function(e,t){return"placeholder"===!e.type||"rawxml"!==e.module?null:t.scopeManager.getValueAsync(e.value,{part:e}).then(function(r){return null==r?t.nullGetter(e):r})}};e.exports=function(){return i(u)}},function(e,t,r){"use strict";var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=r(19),a=r(0),i=a.getLeft,s=a.getRight,u=r(2),l=r(3).getExpandToDefault,p=r(1),c=p.getUnmatchedLoopException,f=p.getClosingTagNotMatchOpeningTag,h=p.throwLocationInvalid;function d(e){switch(e.location){case"start":return 1;case"end":return-1;default:h(e)}}var g={name:"ExpandPairTrait",optionsTransformer:function(e,t){return this.expandTags=t.fileTypeConfig.expandTags.concat(t.options.paragraphLoop?t.fileTypeConfig.onParagraphLoop:[]),e},postparse:function(e,t){var r=this,a=t.getTraits,u=t.postparse,p=a("expandPair",e);p=p.map(function(e){return e||[]});var h=function e(t){var r=[],o=[];if(0===t.length)return{pairs:o,errors:r};var a=1,i=n(t,1)[0];if("start"===i.part.location)for(var s=1;s<t.length;s++){var u=t[s];if(0===(a+=d(u.part))){var l=e(t.slice(s+1));return u.part.value!==i.part.value&&""!==u.part.value?r.push(f({tags:[i.part,u.part]})):o=[[i,u]],{pairs:o.concat(l.pairs),errors:r.concat(l.errors)}}}var p=i.part;r.push(c({part:p,location:p.location}));var h=e(t.slice(1));return{pairs:h.pairs,errors:r.concat(h.errors)}}(p=o(p)),g=h.pairs,v=h.errors,m=g.map(function(t){var n=t[0].part.expandTo;if("auto"===n){var o=l(e,t,r.expandTags);o.error&&v.push(o.error),n=o.value}return n?[i(e,n,t[0].offset),s(e,n,t[1].offset)]:[t[0].offset,t[1].offset]}),y=0,x=void 0;return{postparsed:e.reduce(function(t,r,n){var o=y<g.length&&m[y][0]<=n,a=g[y],i=m[y];if(!o)return t.push(r),t;if(i[0]===n&&(x=[]),a[0].offset!==n&&a[1].offset!==n&&x.push(r),i[1]===n){var s=e[a[0].offset];s.subparsed=u(x,{basePart:s}),delete s.location,delete s.expandTo,t.push(s),y++}return t},[]),errors:v}}};e.exports=function(){return u(g)}},function(e,t,r){"use strict";function n(e,t){for(var r=-1,n=0,o=e.length;n<o;n++)t[n]>=e[n].length||(-1===r||e[n][t[n]].offset<e[r][t[r]].offset)&&(r=n);if(-1===r)throw new Error("minIndex negative");return r}e.exports=function(e){var t=e.reduce(function(e,t){return e+t.length},0);e=e.filter(function(e){return e.length>0});for(var r=new Array(t),o=e.map(function(){return 0}),a=0;a<=t-1;){var i=n(e,o);r[a]=e[i][o[i]],o[i]++,a++}return r}},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=r(2),a=r(1).getScopeCompilationError,i=r(0),s=i.utf8ToWord,u=i.hasCorruptCharacters,l=r(1).throwCorruptCharacters,p={docx:"w",pptx:"a"},c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Render",this.recordRun=!1,this.recordedRun=[]}return n(e,[{key:"set",value:function(e){e.compiled&&(this.compiled=e.compiled),null!=e.data&&(this.data=e.data)}},{key:"getRenderedMap",value:function(e){var t=this;return Object.keys(this.compiled).reduce(function(e,r){return e[r]={from:r,data:t.data},e},e)}},{key:"optionsTransformer",value:function(e,t){return this.parser=t.parser,this.fileType=t.fileType,e}},{key:"postparse",value:function(e){var t=this,r=[];return e.forEach(function(e){if("placeholder"===e.type){var n=e.value;try{t.parser(n,{tag:e})}catch(e){r.push(a({tag:n,rootError:e}))}}}),{postparsed:e,errors:r}}},{key:"recordRuns",value:function(e){e.tag===p[this.fileType]+":r"?(this.recordRun=!1,this.recordedRun=[]):e.tag===p[this.fileType]+":rPr"?("start"===e.position&&(this.recordRun=!0,this.recordedRun=[e.value]),"end"===e.position&&(this.recordedRun.push(e.value),this.recordRun=!1)):this.recordRun&&this.recordedRun.push(e.value)}},{key:"render",value:function(e,t){var r=t.scopeManager;if(t.linebreaks&&this.recordRuns(e),"placeholder"===e.type&&!e.module){var n=r.getValue(e.value,{part:e});if(null==n&&(n=t.nullGetter(e)),u(n)&&l({tag:e.value,value:n}),t.linebreaks){var o=p[this.fileType],a="docx"===this.fileType?"<w:r><w:br/></w:r>":"<a:br/>",i=n.split("\n"),c=this.recordedRun.join("");return{value:i.map(function(e){return s(e)}).join("</"+o+":t></"+o+":r>"+a+"<"+o+":r>"+c+"<"+o+":t>")}}return{value:s(n)}}}}]),e}();e.exports=function(){return o(new c)}}]);